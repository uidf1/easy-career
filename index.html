<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Easy Career</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* --- V12: STABLE LAYOUT & TICKS --- */
        :root {
            --bg: #F2F0EB;
            --card: #FFFFFF;
            --ink: #1A1A1A;
            --gray: #888888;
            --line: #E5E5E5;
        }

        /* 1. БЛОКИРОВКА СТРАНИЦЫ (ЧТОБЫ НЕ ПРЫГАЛА) */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; 
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--ink);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* 2. ЖЕСТКАЯ КАРТОЧКА (НЕ МЕНЯЕТ РАЗМЕР) */
        .card {
            background: var(--card);
            /* Фиксируем размеры, чтобы окно не скакало от длины текста */
            width: 900px; 
            max-width: 95vw; 
            height: 800px; 
            max-height: 90vh;
            
            padding: 0;
            border: 1px solid #D0D0D0;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 30px 60px -15px rgba(0,0,0,0.08);
        }

        /* ЗОНА КОНТЕНТА (СКРОЛЛ ТОЛЬКО ЗДЕСЬ) */
        .content-area {
            flex: 1;
            padding: 60px 80px; /* Большие отступы */
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }
        
        /* Центровка вопросов (Чтобы были всегда в одном месте) */
        .quiz-wrapper {
            margin-top: 80px; /* Отступ сверху фиксирован, чтобы не прыгало по вертикали */
            width: 100%;
            max-width: 700px;
            align-self: center; 
        }

        /* Скрываем скроллбар */
        .content-area::-webkit-scrollbar { width: 0; }

        /* ТИПОГРАФИКА */
        h1 { font-weight: 800; font-size: 3em; letter-spacing: -0.03em; margin: 0 0 20px 0; line-height: 1.1; }
        h2 { font-weight: 600; font-size: 2em; letter-spacing: -0.02em; margin: 0 0 40px 0; line-height: 1.3; min-height: 2.6em; /* Резерв места под 2 строки */ }
        p { font-size: 1.2em; line-height: 1.6; color: var(--gray); margin-bottom: 40px; }
        .label { font-size: 0.8em; text-transform: uppercase; letter-spacing: 0.15em; font-weight: 700; color: var(--gray); margin-bottom: 25px; display: block; }

        /* КНОПКИ */
        .btn {
            display: block;
            width: 100%;
            padding: 24px 32px;
            margin-bottom: 15px;
            background: transparent;
            border: 1px solid var(--line);
            color: var(--ink);
            cursor: pointer;
            font-size: 1.15em;
            font-weight: 500;
            text-align: left;
            transition: all 0.2s;
            box-sizing: border-box; /* Важно для ширины */
        }
        .btn:hover { background: #F9F9F9; border-color: var(--ink); padding-left: 38px; }
        
        .btn-main {
            background: var(--ink);
            color: #FFF;
            border: 1px solid var(--ink);
            text-align: center;
            font-weight: 600;
            padding: 22px;
            font-size: 1.1em;
            cursor: pointer;
            width: 100%;
            margin: 40px auto 0 auto;
        }
        .btn-main:hover { background: #333; }

        /* --- 3. СЛАЙДЕР С ЗАСЕЧКАМИ --- */
        .slider-wrap { 
            margin: 60px 0 20px 0; 
            position: relative; 
            height: 40px; 
            display: flex; 
            align-items: center; 
        }
        
        /* ЗАСЕЧКИ (ТИКИ) */
        .ticks {
            position: absolute; 
            top: 50%; left: 0; right: 0; 
            transform: translateY(-50%);
            display: flex; 
            justify-content: space-between; 
            pointer-events: none; 
            z-index: 0;
            padding: 0 10px; /* Отступ под размер ползунка */
        }
        .tick { width: 2px; height: 12px; background: #DDD; }
        .tick.big { height: 24px; background: #BBB; } /* Большие засечки по краям и в центре */

        /* INPUT */
        input[type=range] {
            -webkit-appearance: none; width: 100%; background: transparent; margin: 0; z-index: 2; position: relative;
        }
        input[type=range]:focus { outline: none; }
        
        /* Дорожка (Прозрачная, т.к. у нас тики) */
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 40px; background: transparent; cursor: pointer; border: none;
        }
        
        /* Ползунок (Квадрат) */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; 
            height: 32px; width: 32px; 
            background: var(--ink); 
            margin-top: 4px; /* Центровка */
            cursor: pointer; 
            border: 3px solid #FFF; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:active { transform: scale(1.1); }

        /* ПОДПИСИ */
        .slider-labels {
            display: flex; justify-content: space-between; margin-top: 10px; 
            font-size: 0.9em; font-weight: 600; color: var(--gray); text-transform: uppercase; letter-spacing: 0.05em;
        }
        .text-center { text-align: center; }
        .text-right { text-align: right; }

        /* АККОРДЕОНЫ */
        .acc-item { border: 1px solid var(--line); margin-bottom: -1px; }
        .acc-head {
            padding: 25px 30px; cursor: pointer; font-weight: 600; display: flex; justify-content: space-between; align-items: center; font-size: 1.1em;
        }
        .acc-head:hover { background: #FAFAFA; }
        .acc-icon { font-size: 1.5em; font-weight: 300; }
        .acc-body { display: none; padding: 0 30px 30px 30px; line-height: 1.7; color: #555; }
        .acc-item.open .acc-body { display: block; }
        .acc-item.open .acc-head { background: #F9F9F9; }

        /* ПРОГРЕСС */
        .progress-track { position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: #EEE; z-index: 10; }
        .progress-fill { height: 100%; background: var(--ink); width: 0%; transition: width 0.4s; }

        /* СПИСКИ */
        .job-row { display: flex; justify-content: space-between; padding: 18px 0; border-bottom: 1px solid #EEE; align-items: center; }
        .job-score { font-weight: 700; color: var(--ink); font-size: 1.1em; }

        .hidden { display: none !important; }
        .fade-in { animation: fade 0.5s ease-out; }
        @keyframes fade { from { opacity: 0; } to { opacity: 1; } }

        @media (max-width: 600px) {
            .card { width: 100%; height: 100%; max-height: none; border: none; }
            .content-area { padding: 30px 20px; }
            .quiz-wrapper { margin-top: 20px; }
            h1 { font-size: 2.2em; }
            .slider-labels { font-size: 0.7em; }
        }
    </style>
</head>
<body>

<div class="card fade-in">
    
    <div id="view-intro" class="content-area" style="justify-content: center;">
        <div style="max-width: 600px; margin: 0 auto;">
            <span class="label">EASY CAREER 12.0</span>
            <h1>Профессиональный профиль</h1>
            <p>
                Алгоритмический анализ личности. 
                Мы объединили MBTI и RIASEC, чтобы построить вашу точную карьерную карту.
            </p>
            <div style="margin-bottom: 40px; padding-top: 20px; border-top: 1px solid var(--line);">
                <div style="font-size: 0.9em; color: var(--ink); font-weight: 600; margin-bottom: 15px;">ЭТАПЫ АНАЛИЗА:</div>
                <div style="color: var(--gray); font-size: 0.95em; line-height: 1.8;">
                    01. Стиль мышления<br>
                    02. Глубинные интересы<br>
                    03. Кейсы<br>
                    04. Ценности
                </div>
            </div>
            <button class="btn btn-main" onclick="nextScreen('level')">Начать анализ</button>
        </div>
    </div>

    <div id="view-level" class="content-area hidden" style="justify-content: center; text-align: center;">
        <div style="max-width: 600px; margin: 0 auto;">
            <span class="label" id="lvl-num">БЛОК 1</span>
            <h1 id="lvl-title">Базовые настройки</h1>
            <p id="lvl-desc">Определим ваш способ взаимодействия с миром.</p>
            <button class="btn btn-main" style="width: auto; padding-left: 60px; padding-right: 60px;" onclick="startQuiz()">Приступить</button>
        </div>
    </div>

    <div id="view-quiz" class="hidden" style="display: flex; flex-direction: column; height: 100%;">
        <div class="progress-track"><div class="progress-fill" id="bar"></div></div>
        
        <div class="content-area">
            <div class="quiz-wrapper">
                <span class="label" id="q-counter">ВОПРОС 1 / 10</span>
                <h2 id="q-text">...</h2>

                <div id="type-btn" class="hidden"></div>

                <div id="type-slide" class="hidden">
                    <div class="slider-wrap">
                        <div class="ticks">
                            <div class="tick big"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div>
                            <div class="tick big"></div>
                            <div class="tick"></div><div class="tick"></div><div class="tick"></div><div class="tick"></div><div class="tick big"></div>
                        </div>
                        <input type="range" min="0" max="10" value="5" id="slider">
                    </div>
                    
                    <div class="slider-labels">
                        <span style="width:33%">Полностью<br>несогласен</span>
                        <span style="width:33%" class="text-center">Нейтрально</span>
                        <span style="width:33%" class="text-right">Полностью<br>согласен</span>
                    </div>

                    <button class="btn btn-main" onclick="submitSlide()">Подтвердить</button>
                </div>
            </div>
        </div>
    </div>

    <div id="view-result" class="content-area hidden">
        <div style="max-width: 700px; margin: 0 auto; width: 100%;">
            <span class="label">ВАШ ПРОФИЛЬ</span>
            <h1 id="res-code" style="margin-bottom: 5px;">...</h1>
            <div id="res-name" style="font-size: 1.4em; color: var(--gray); margin-bottom: 40px;">...</div>

            <div style="width: 80%; max-width: 450px; margin: 0 auto 40px auto; padding: 20px 0; border-bottom: 1px solid var(--line);">
                <canvas id="radarChart"></canvas>
            </div>

            <div style="margin-top: 30px;">
        
        <div class="acc-item open">
            <div class="acc-head" onclick="toggle(this)">
                <span>Характеристика личности</span>
                <span class="acc-icon">−</span> </div>
            <div class="acc-body" id="res-desc">...</div>
        </div>
        
        <div class="acc-item">
            <div class="acc-head" onclick="toggle(this)">
                <span>Сильные стороны</span>
                <span class="acc-icon">+</span>
            </div>
            <div class="acc-body" id="res-strengths">...</div>
        </div>

        <div class="acc-item">
            <div class="acc-head" onclick="toggle(this)">
                <span>Зоны роста и слабости</span>
                <span class="acc-icon">+</span>
            </div>
            <div class="acc-body" id="res-weaknesses">...</div>
        </div>

        <div class="acc-item">
            <div class="acc-head" onclick="toggle(this)">
                <span>Что вызывает стресс?</span>
                <span class="acc-icon">+</span>
            </div>
            <div class="acc-body" id="res-stress">...</div>
        </div>

        <div class="acc-item">
            <div class="acc-head" onclick="toggle(this)">
                <span>Взаимоотношения с людьми</span>
                <span class="acc-icon">+</span>
            </div>
            <div class="acc-body" id="res-relations">...</div>
        </div>

        <div class="acc-item">
            <div class="acc-head" onclick="toggle(this)">
                <span>Любовь и семья</span>
                <span class="acc-icon">+</span>
            </div>
            <div class="acc-body" id="res-love">...</div>
        </div>

        <div class="acc-item">
            <div class="acc-head" onclick="toggle(this)">
                <span>Карьерная стратегия</span>
                <span class="acc-icon">+</span>
            </div>
            <div class="acc-body">
                <div id="top-job-advice" style="background: #F4F4F4; padding: 20px; border-radius: 0px; margin-bottom: 25px; border-left: 4px solid var(--ink);">
                    ...
                </div>
                <p style="margin-bottom: 15px; font-weight: 600;">Ваш топ профессий:</p>
                <div id="jobs-list"></div>
            </div>
        </div>
    </div>

            <button class="btn btn-main" style="margin-top: 50px; margin-bottom: 20px;" onclick="location.reload()">Новый анализ</button>
        </div>
    </div>

</div>

<script>
    // --- КОНТЕНТ (40 вопросов) ---
    const levels = [
        // БЛОК 1: ПСИХОТИП (MBTI)
        {
            title: "Стиль Мышления",
            desc: "Блок 1 из 5. Как вы взаимодействуете с миром?",
            qs: [
                { type: "btn", text: "Как восстанавливаете силы?", opts: [{t:"В шумной компании", a:{E:3}}, {t:"В одиночестве", a:{I:3}}] },
                { type: "slide", text: "Мне легко заговорить с незнакомым человеком.", t_a:"E", t_r:"S" },
                { type: "btn", text: "Принимая решение, вы опираетесь на...", opts: [{t:"Логику и факты", a:{T:3}}, {t:"Чувства и людей", a:{F:3}}] },
                { type: "slide", text: "Я часто живу мечтами о будущем.", t_a:"N", t_r:"A" },
                { type: "btn", text: "Ваш подход к делам?", opts: [{t:"Строгий план", a:{J:3}}, {t:"Импровизация", a:{P:3}}] },
                { type: "slide", text: "Правда важнее, чем чувства собеседника.", t_a:"T", t_r:"I" },
                { type: "slide", text: "Я люблю четкие инструкции.", t_a:"J", t_r:"C" },
                { type: "btn", text: "Вы скорее...", opts: [{t:"Практик-реалист", a:{S:3}}, {t:"Теоретик-мечтатель", a:{N:3}}] },
                { type: "slide", text: "Я люблю быть в центре внимания.", t_a:"E", t_r:"E" },
                { type: "btn", text: "В споре вы...", opts: [{t:"Доказываете правоту", a:{T:2}}, {t:"Ищете компромисс", a:{F:2}}] },
                { type: "slide", text: "Я замечаю мелкие детали, которые не видят другие.", t_a:"S", t_r:"C" },
                { type: "btn", text: "Дедлайн горит. Вы...", opts: [{t:"В панике ускоряюсь", a:{P:2}}, {t:"Спокойно завершаю", a:{J:2}}] }
            ]
        },
        
        // БЛОК 2: ИНТЕРЕСЫ (RIASEC)
        {
            title: "Вектор Интересов",
            desc: "Блок 2 из 5. Что вас действительно увлекает?",
            qs: [
                { type: "slide", text: "Мне интересно копаться в 'железе', механизмах или коде.", t_r:"R" },
                { type: "slide", text: "Я люблю решать сложные логические задачи.", t_r:"I" },
                { type: "slide", text: "Я хочу создавать что-то красивое (визуал, текст, музыку).", t_r:"A" },
                { type: "slide", text: "Мне нравится заботиться о людях, лечить или учить.", t_r:"S" },
                { type: "slide", text: "Я люблю управлять людьми и продавать.", t_r:"E" },
                { type: "slide", text: "Мне комфортно с таблицами, документами и цифрами.", t_r:"C" },
                { type: "btn", text: "Что выберете?", opts: [{t:"Ремонт своими руками", r:{R:3}}, {t:"Поход в музей", r:{A:3}}] },
                { type: "btn", text: "Ваш выбор?", opts: [{t:"Научный эксперимент", r:{I:3}}, {t:"Запуск стартапа", r:{E:3}}] },
                { type: "btn", text: "Что ближе?", opts: [{t:"Волонтерство/Помощь", r:{S:3}}, {t:"Архив/Аналитика", r:{C:3}}] },
                { type: "slide", text: "Я готов рисковать деньгами ради прибыли.", t_r:"E" },
                { type: "slide", text: "Меня успокаивает монотонная работа.", t_r:"C" },
                { type: "slide", text: "Я хочу понять законы Вселенной.", t_r:"I" }
            ]
        },

        // БЛОК 3: НАВЫКИ И РЕАЛЬНОСТЬ (GPS-НАВИГАЦИЯ) — ЭТО НОВОЕ!
        {
            title: "Реальность",
            desc: "Блок 3 из 5. Честная оценка ваших возможностей.",
            qs: [
                // ПЕРЕПИСАННЫЕ ВОПРОСЫ ПОД "СОГЛАСЕН/НЕ СОГЛАСЕН"
                { type: "slide", text: "У меня отличные способности к математике и логике.", skill: "math" }, 
                { type: "slide", text: "Я обладаю высокой физической силой и выносливостью.", skill: "phys" },
                { type: "slide", text: "У меня хорошо развито чувство стиля и умение рисовать.", skill: "art" },
                { type: "slide", text: "Я легко справляюсь с высоким уровнем стресса и давлением.", skill: "stress" },
                
                // Фильтры (кнопки) оставляем как было
                { type: "btn", text: "Готовы учиться 6+ лет (Медицина/Наука)?", opts: [
                    {t:"Да, готов посвятить жизнь", filter:{studyLong:true}}, 
                    {t:"Нет, хочу работать быстрее", filter:{studyLong:false}}
                ]},
                { type: "btn", text: "Отношение к виду крови и анатомии?", opts: [
                    {t:"Спокойное / Интересно", filter:{blood:true}}, 
                    {t:"Мне становится плохо", filter:{blood:false}} 
                ]},
                { type: "btn", text: "Важна ли возможность удаленки?", opts: [
                    {t:"Критически важна (Только дом)", filter:{remoteOnly:true}}, 
                    {t:"Не важна / Хочу в офис", filter:{remoteOnly:false}} 
                ]},
                { type: "btn", text: "Готовы к тяжелому физическому труду?", opts: [
                    {t:"Да, люблю работать телом", filter:{manual:true}}, 
                    {t:"Нет, только головой", filter:{manual:false}} 
                ]},
                
                // ПЕРЕПИСАННЫЕ ВОПРОСЫ ПОД "СОГЛАСЕН/НЕ СОГЛАСЕН"
                { type: "slide", text: "Я свободно владею иностранными языками.", skill: "lang" },
                { type: "slide", text: "Я уверенно чувствую себя, выступая перед большой публикой.", skill: "speak" },
                
                // Фильтры (кнопки) оставляем как было
                { type: "btn", text: "Предпочтительный график?", opts: [
                    {t:"Четкий 5/2 с 9 до 18", filter:{schedule:true}}, 
                    {t:"Гибкий / Ненормированный", filter:{schedule:false}} 
                ]},
                { type: "btn", text: "Стиль работы?", opts: [
                    {t:"Командный игрок", r:{S:2, E:1}}, 
                    {t:"Волк-одиночка", r:{I:2, R:1}} 
                ]}
            ]
        },

        // БЛОК 4: СИТУАЦИИ
        {
            title: "Проф. Ситуации",
            desc: "Блок 4 из 5. Примерьте роли на себя.",
            qs: [
                { type: "btn", text: "Вам дали бюджет. Что откроете?", opts: [{t:"IT-компанию", r:{I:3, R:2}}, {t:"Арт-пространство", r:{A:4}}] },
                { type: "btn", text: "Любимый школьный предмет?", opts: [{t:"Алгебра/Физика", r:{I:3}}, {t:"Литература/История", r:{A:2, S:2}}] },
                { type: "slide", text: "Я бы хотел проводить сложные операции.", t_r:"R" }, // + Хирург
                { type: "slide", text: "Я бы хотел проектировать небоскребы.", t_r:"A" }, // + Архитектор
                { type: "btn", text: "Роль в проекте?", opts: [{t:"Лидер-организатор", r:{E:3}}, {t:"Эксперт-исполнитель", r:{R:2, I:2}}] },
                { type: "btn", text: "Что выберете?", opts: [{t:"Общение с клиентами", r:{S:3}}, {t:"Анализ базы данных", r:{C:3}}] },
                { type: "slide", text: "Меня не пугает однообразная работа.", t_r:"C" },
                { type: "slide", text: "Я постоянно фонтанирую идеями.", t_r:"A" },
                { type: "btn", text: "Идеальный отпуск?", opts: [{t:"Экстрим/Поход", r:{R:3}}, {t:"Комфорт/Экскурсии", r:{S:2}}] },
                { type: "btn", text: "Рабочее место?", opts: [{t:"Опенспейс", r:{E:2, S:2}}, {t:"Тихий кабинет", r:{I:3}}] },
                { type: "slide", text: "Я умею убеждать людей.", t_r:"E" },
                { type: "slide", text: "Я люблю животных и природу.", t_r:"R" }
            ]
        },

        // БЛОК 5: ЦЕННОСТИ (ФИНАЛ)
        {
            title: "Истинные Цели",
            desc: "Блок 5 из 5. Ради чего вы будете работать?",
            qs: [
                { type: "btn", text: "Главный критерий успеха?", opts: [{t:"Деньги и Власть", r:{E:4}}, {t:"Смысл и Польза", r:{S:4}}] },
                { type: "slide", text: "Я хочу изменить мир глобально.", t_r:"S" },
                { type: "slide", text: "Я хочу понять тайны мироздания.", t_r:"I" },
                { type: "btn", text: "Что важнее?", opts: [{t:"Карьерная лестница", r:{E:3}}, {t:"Work-Life Balance", r:{C:2}}] },
                { type: "btn", text: "Через 10 лет вы...", opts: [{t:"Владелец бизнеса", r:{E:4}}, {t:"Уникальный Гуру", r:{I:3}}] },
                { type: "slide", text: "Конкуренция меня драйвит.", t_r:"E" },
                { type: "slide", text: "Безопасность превыше всего.", t_r:"C" },
                { type: "btn", text: "Ваш девиз?", opts: [{t:"Семь раз отмерь", a:{J:3}}, {t:"Главное начать", a:{P:3}}] },
                { type: "btn", text: "Если бы не платили, вы бы...", opts: [{t:"Путешествовали", a:{P:3}}, {t:"Учились новому", a:{N:3}}] },
                { type: "btn", text: "В итоге, вы...", opts: [{t:"Реалист", a:{S:3}}, {t:"Визионер", a:{N:3}}] },
                { type: "slide", text: "Я хочу создавать материальные вещи.", t_r:"R" },
                { type: "slide", text: "Я хочу оставить след в истории.", t_r:"A" }
            ]
        }
    ];

    // --- ПРОФЕССИИ ---
   // --- 2. БАЗА ПРОФЕССИЙ (С СОВЕТАМИ) ---
    const jobs = [
        {
            n:"Backend-разработчик", r:{R:20,I:100,A:10,S:0,E:10,C:60}, req:{math:7, remote:true, stress:5, study:true},
            advice: "Начните с изучения Python или Go. Напишите свой первый API и разберитесь с базами данных (SQL). Сделайте пет-проект: например, телеграм-бота с админкой."
        },
        {
            n:"Fullstack-разработчик", r:{R:30,I:90,A:30,S:10,E:20,C:50}, req:{math:6, remote:true, stress:6, study:true},
            advice: "Вам нужно знать и 'лицо', и 'изнанку' сайта. Изучите HTML/CSS + JavaScript (React), а затем Node.js. Соберите простой интернет-магазин с нуля."
        },
        {
            n:"Data Scientist", r:{R:10,I:100,A:10,S:0,E:20,C:80}, req:{math:9, remote:true, stress:4, study:true},
            advice: "Освежите математическую статистику. Изучите Python (библиотеки Pandas, NumPy). Скачайте реальный датасет с Kaggle и попробуйте найти в нем закономерности."
        },
        {
            n:"Кибербезопасность", r:{R:50,I:90,A:10,S:10,E:30,C:80}, req:{math:7, remote:true, stress:7, study:true},
            advice: "Изучите, как работают сети (TCP/IP) и ОС Linux. Попробуйте пройти CTF-соревнования (Capture The Flag) для новичков, чтобы понять логику взлома и защиты."
        },
        {
            n:"DevOps Инженер", r:{R:60,I:80,A:0,S:10,E:20,C:90}, req:{math:6, remote:true, stress:6, study:false},
            advice: "Разберитесь с Docker и контейнерами. Изучите Linux на уровне администратора. Попробуйте настроить автоматическую сборку кода (CI/CD) на GitHub."
        },
        {
            n:"Хирург", r:{R:90,I:80,A:10,S:60,E:20,C:40}, req:{blood:true, stress:10, manual:true, study:true, remote:false},
            advice: "Это марафон на 8+ лет. Начните с углубленной биологии и химии. Попробуйте устроиться волонтером или санитаром в больницу, чтобы увидеть реальность без романтики."
        },
        {
            n:"Стоматолог", r:{R:80,I:70,A:20,S:50,E:30,C:60}, req:{blood:true, manual:true, study:true, remote:false},
            advice: "Развивайте мелкую моторику (лепка, моделирование). Ищите вузы с сильной практической базой. Это профессия, где 'руки кормят' буквально."
        },
        {
            n:"Психотерапевт", r:{R:0,I:70,A:40,S:100,E:20,C:10}, req:{stress:8, remote:true, study:true},
            advice: "Читайте фундаментальную литературу (Фрейд, Юнг, Ялом), а не поп-психологию. Вам нужно высшее образование. Учитесь слушать людей, не перебивая."
        },
        {
            n:"Генетик", r:{R:30,I:100,A:20,S:20,E:10,C:50}, req:{math:6, study:true, remote:false},
            advice: "Биология + Информатика = Ваше будущее. Изучайте биоинформатику. Следите за новостями про CRISPR и редактирование генома."
        },
        {
            n:"Биотехнолог", r:{R:40,I:90,A:10,S:30,E:20,C:60}, req:{math:5, study:true, remote:false},
            advice: "Вам нужна химия на высоком уровне. Ищите стажировки в фармкомпаниях или агрохолдингах. Это наука, которая становится продуктом."
        },
        {
            n:"Предприниматель", r:{R:30,I:60,A:40,S:50,E:100,C:20}, req:{stress:9, remote:true, math:4},
            advice: "Не учитесь 'бизнесу', учитесь продавать. Попробуйте купить что-то дешевле и продать дороже. Запустите микро-проект, чтобы понять, как работают деньги."
        },
        {
            n:"Product Manager", r:{R:20,I:60,A:30,S:60,E:90,C:50}, req:{stress:8, remote:true, math:5},
            advice: "Научитесь задавать вопрос 'Зачем?'. Изучите CustDev (интервью с пользователями). Попробуйте описать бизнес-модель любого приложения в вашем телефоне."
        },
        {
            n:"Маркетолог", r:{R:10,I:60,A:60,S:50,E:90,C:40}, req:{art:4, remote:true, stress:6},
            advice: "Выберите одну нишу: таргет, контекст или SMM. Попробуйте настроить рекламу для друга или своего блога. Анализируйте, почему вы сами кликаете на рекламу."
        },
        {
            n:"HR-Директор", r:{R:10,I:40,A:20,S:100,E:80,C:40}, req:{stress:7, remote:true, math:2},
            advice: "Изучите Трудовой кодекс и психологию личности. Попробуйте провести тестовое собеседование с другом. Ваша задача — видеть потенциал в людях."
        },
        {
            n:"Менеджер по продажам", r:{R:20,I:20,A:10,S:80,E:100,C:30}, req:{stress:9, remote:true, math:3},
            advice: "Прочитайте книги по переговорам (например, 'Сначала скажите НЕТ'). Устройтесь на подработку в колл-центр — это лучшая школа жизни и стрессоустойчивости."
        },
        {
            n:"UX/UI Дизайнер", r:{R:10,I:50,A:100,S:40,E:20,C:30}, req:{art:8, remote:true, stress:4},
            advice: "Скачайте Figma. Не рисуйте с нуля, а копируйте интерфейсы популярных приложений, чтобы понять их логику. Изучите гайдлайны iOS и Android."
        },
        {
            n:"Архитектор", r:{R:50,I:70,A:90,S:20,E:30,C:50}, req:{art:7, math:6, study:true, remote:false},
            advice: "Рисуйте, чертите, изучайте историю искусств и сопромат. Освойте программы Revit или AutoCAD. Гуляйте по городу, анализируя здания, а не просто глядя на них."
        },
        {
            n:"Графический дизайнер", r:{R:10,I:30,A:100,S:20,E:30,C:20}, req:{art:9, remote:true},
            advice: "Соберите портфолио на Behance, даже если это выдуманные проекты. Изучите основы композиции, типографики и цвета. Освойте Adobe Illustrator."
        },
        {
            n:"Режиссер", r:{R:20,I:40,A:100,S:60,E:70,C:10}, req:{art:8, stress:9, remote:false},
            advice: "Снимите короткометражку на телефон. Главное — история, а не камера. Изучайте драматургию и монтаж. Смотрите фильмы покадрово, анализируя свет."
        },
        {
            n:"3D-Художник", r:{R:40,I:40,A:100,S:10,E:10,C:40}, req:{art:7, remote:true, math:4},
            advice: "Скачайте Blender (он бесплатный). Начните с туториала 'пончик'. Разберитесь с полигонами, текстурами и светом. Соберите свою первую сцену."
        },
        {
            n:"Финансовый аналитик", r:{R:10,I:80,A:0,S:20,E:50,C:100}, req:{math:8, stress:6, remote:true},
            advice: "Excel — ваш лучший друг (освойте сводные таблицы и макросы). Изучите основы бухучета и финансового моделирования. Читайте финансовые новости."
        },
        {
            n:"Аудитор", r:{R:20,I:70,A:0,S:30,E:40,C:100}, req:{math:7, remote:false, stress:5},
            advice: "Внимание к деталям — ваше всё. Изучайте стандарты отчетности (МСФО). Будьте готовы к командировкам и работе с большим объемом документов."
        },
        {
            n:"Бухгалтер", r:{R:10,I:40,A:0,S:20,E:30,C:100}, req:{math:6, remote:true, stress:3},
            advice: "Пройдите курсы 1С. Изучите налоговый кодекс. Это профессия про порядок и ответственность. Начните с помощи в ведении ИП знакомым."
        },
        {
            n:"Инженер-конструктор", r:{R:100,I:70,A:10,S:10,E:20,C:60}, req:{math:7, manual:true, study:true, remote:false},
            advice: "Разберитесь, как работают механизмы. Изучайте физику и черчение. Освойте CAD-системы (Компас-3D, SolidWorks)."
        },
        {
            n:"Пилот", r:{R:100,I:50,A:10,S:20,E:30,C:80}, req:{math:5, stress:9, manual:true, study:true, remote:false},
            advice: "Здоровье и английский язык — это база. Попробуйте полетать на симуляторе. Путь в небо начинается с летного училища и жесткой медкомиссии."
        },
        {
            n:"Шеф-повар", r:{R:90,I:30,A:80,S:40,E:60,C:50}, req:{manual:true, stress:9, art:5, remote:false},
            advice: "Идите работать на кухню (даже чистить картошку), чтобы понять ритм. Учитесь чувствовать вкусы и химию продуктов. Готовьте много и для всех."
        },
        {
            n:"Агроном", r:{R:90,I:70,A:10,S:20,E:40,C:50}, req:{manual:true, remote:false, study:true},
            advice: "Современный агроном — это не лопата, а планшет и дроны. Изучайте биологию растений и современные агротехнологии. Практика — только в поле."
        },
        {
            n:"Логист", r:{R:40,I:50,A:0,S:30,E:60,C:90}, req:{math:5, stress:7},
            advice: "Развивайте системное мышление. Изучите географию перевозок и основы ВЭД (внешнеэкономической деятельности). Английский или Китайский будут огромным плюсом."
        },
        {
            n:"Адвокат", r:{R:10,I:80,A:20,S:50,E:90,C:60}, req:{stress:8, study:true, remote:false},
            advice: "Учитесь говорить убедительно и писать грамотно. Изучайте законы, но главное — судебную практику. Ходите в суды как слушатель, смотрите, как работают профи."
        },
        {
            n:"Журналист", r:{R:20,I:70,A:80,S:70,E:50,C:20}, req:{art:6, stress:7, remote:true},
            advice: "Заведите блог и пишите каждый день. Учитесь искать информацию и проверять факты. Будьте любопытны и не бойтесь задавать неудобные вопросы."
        },
        {
            n:"Учитель", r:{R:10,I:50,A:40,S:100,E:40,C:30}, req:{stress:8, remote:false, study:true},
            advice: "Попробуйте репетиторство. Если вам нравится объяснять сложное простыми словами и вы терпеливы — это ваше. Изучайте возрастную психологию."
        },
        {
            n:"Переводчик", r:{R:10,I:60,A:70,S:50,E:30,C:40}, req:{lang:9, remote:true},
            advice: "Погрузитесь в языковую среду (фильмы, книги, общение). Учите не только слова, но и культуру. Попробуйте переводить статьи или субтитры для практики."
        },
        {
            n:"Эколог", r:{R:60,I:90,A:10,S:50,E:30,C:40}, req:{study:true, remote:false},
            advice: "Начните с волонтерства в экологических организациях. Изучайте химию и правовые нормы охраны природы. Это работа для тех, кому не всё равно."
        },
        {
            n:"Геолог", r:{R:90,I:90,A:0,S:10,E:10,C:30}, req:{manual:true, remote:false, study:true},
            advice: "Готовьтесь к походной жизни. Изучайте физику земли и минералогию. Если романтика экспедиций и палаток вам близка — дерзайте."
        },
        {
            n:"Фармацевт", r:{R:50,I:80,A:0,S:60,E:20,C:80}, req:{math:5, study:true, remote:false},
            advice: "Химия — ваш главный предмет. Вам нужна точность и хорошая память. Это стабильная профессия на стыке медицины и науки."
        },
        {
            n:"Ветеринар", r:{R:80,I:70,A:10,S:60,E:30,C:40}, req:{blood:true, manual:true, study:true, remote:false},
            advice: "Животные не могут сказать, где болит. Вам нужно огромное терпение и любовь к ним. Волонтерство в приюте покажет, готовы ли вы к этому."
        },
        {
            n:"Event-менеджер", r:{R:30,I:20,A:60,S:80,E:90,C:50}, req:{stress:10, remote:false, art:4},
            advice: "Организуйте день рождения друга или мероприятие в университете. Учитесь работать в режиме многозадачности и решать форс-мажоры с улыбкой."
        },
        {
            n:"Банкир", r:{R:10,I:60,A:0,S:40,E:80,C:80}, req:{math:7, stress:8, remote:false},
            advice: "Начните с позиции стажера в отделении банка. Изучайте финансовые продукты и экономику. Важны коммуникабельность и внимательность."
        },
        {
            n:"Следователь", r:{R:60,I:80,A:10,S:40,E:50,C:70}, req:{stress:9, blood:true, remote:false},
            advice: "Развивайте логику и наблюдательность. Юридическое образование обязательно. Будьте готовы к ненормированному графику и жесткой дисциплине."
        },
        {
            n:"Дипломат", r:{R:10,I:70,A:30,S:90,E:80,C:50}, req:{lang:8, stress:8, study:true, remote:false},
            advice: "Учите языки и историю. Развивайте ораторское мастерство и эмоциональный интеллект. Умение договариваться и этикет — ваше оружие."
        },
        {
            n:"Фитнес-тренер", r:{R:80,I:30,A:20,S:90,E:50,C:30}, req:{phys:9, remote:false},
            advice: "Изучите анатомию и физиологию, чтобы не навредить клиентам. Ваш внешний вид — ваша визитка. Получите сертификат тренера."
        },
        {
            n:"Копирайтер", r:{R:0,I:50,A:90,S:30,E:40,C:20}, req:{art:7, remote:true},
            advice: "Пишите много. Читайте книги типа 'Пиши, сокращай'. Научитесь писать продающие тексты, а не школьные сочинения. Ищите первые заказы на биржах."
        },
        {
            n:"Видеооператор", r:{R:70,I:20,A:80,S:30,E:20,C:40}, req:{art:6, manual:true, remote:false},
            advice: "Снимайте всё вокруг. Изучите настройки камеры (ISO, выдержка, диафрагма). Освойте монтаж в Premiere Pro или DaVinci Resolve."
        },
        {
            n:"Звукорежиссер", r:{R:60,I:40,A:80,S:20,E:10,C:50}, req:{art:5, remote:false},
            advice: "Слушайте музыку аналитически (раскладывая на инструменты). Освойте программы для работы со звуком (Cubase, Logic). Практикуйтесь на концертах или в студиях."
        },
        {
            n:"Библиотекарь", r:{R:20,I:50,A:40,S:40,E:10,C:90}, req:{stress:1, remote:false},
            advice: "Если вы любите тишину, порядок и систематизацию — это для вас. Современный библиотекарь также работает с цифровыми архивами и проводит мероприятия."
        },
        {
            n:"Полицейский", r:{R:80,I:40,A:0,S:70,E:60,C:80}, req:{phys:7, stress:9, remote:false},
            advice: "Нужна отличная физподготовка и чистое прошлое. Готовьтесь к службе в армии или поступайте в профильный вуз МВД. Это служба, а не просто работа."
        },
        {
            n:"Военный", r:{R:90,I:30,A:0,S:40,E:60,C:90}, req:{phys:8, stress:10, remote:false},
            advice: "Дисциплина и подчинение приказу. Хорошая физическая форма обязательна. Военное училище — старт карьеры офицера."
        },
        {
            n:"Актёр", r:{R:10,I:20,A:100,S:70,E:40,C:10}, req:{art:9, speak:10, remote:false},
            advice: "Запишитесь в театральную студию. Развивайте речь, пластику и память. Ходите на кастинги. Будьте готовы к отказам — это часть профессии."
        },
        {
            n:"Социолог", r:{R:10,I:90,A:20,S:60,E:30,C:50}, req:{math:5, study:true},
            advice: "Интерес к людям и данным. Учитесь составлять анкеты и анализировать статистику (SPSS). Читайте социологические исследования."
        },
        {
            n:"Нутрициолог", r:{R:40,I:70,A:20,S:80,E:40,C:50}, req:{study:false, remote:true},
            advice: "Разберитесь в биохимии питания. Пройдите курсы доказательной нутрициологии. Начните вести блог о здоровом питании и консультировать."
        }
    ];

    // --- ОПИСАНИЯ MBTI ---
    const mbtiInfo = {
        // === ТИП №1: INTJ (СТРАТЕГ) - ПОЛНОЕ ДОСЬЕ ===
        "INTJ": {
            name: "Стратег",
            desc: `
                <p>Вы — интеллектуальный архитектор своего мира. Людей вашего типа часто называют «серыми кардиналами» или «визионерами». Вы не просто мечтаете, вы строите конкретные планы по реализации своих идей. Для вас жизнь — это огромная шахматная доска, где каждый ход должен быть продуман.</p>
                <p>Вы обладаете редкой способностью видеть структуру там, где другие видят хаос. Вы скептичны, независимы и цените компетентность превыше всего. Вас сложно впечатлить авторитетом или громкими титулами — вы уважаете только реальные знания и логику.</p>
                <p>Ваш ум работает 24/7. Вы постоянно ищете способы оптимизировать процессы, будь то рабочий проект или маршрут до магазина. Рутина и бессмысленные ритуалы вызывают у вас физическую боль.</p>
            `,
            strengths: `
                <ul>
                    <li><b>Стратегическое мышление.</b> Вы всегда на три шага впереди. Вы видите последствия решений, которые другим кажутся неочевидными.</li>
                    <li><b>Независимость.</b> Вы не нуждаетесь в одобрении толпы. Вы можете работать в одиночку годами, если верите в свою идею.</li>
                    <li><b>Обучаемость.</b> Вы способны освоить любую сложную теорию, если она нужна вам для дела.</li>
                    <li><b>Решительность.</b> Пока другие сомневаются, вы действуете. Вы принимаете жесткие решения хладнокровно.</li>
                </ul>
            `,
            weaknesses: `
                <ul>
                    <li><b>Высокомерие.</b> Иногда вы считаете окружающих слишком медлительными или «недалекими», и не стесняетесь это показывать.</li>
                    <li><b>Игнорирование эмоций.</b> Вы часто забываете, что люди — не роботы. Логика для вас важнее чувств, что обижает близких.</li>
                    <li><b>Перфекционизм.</b> Вы можете бесконечно улучшать проект и не выпускать его, потому что он «еще недостаточно идеален».</li>
                    <li><b>Склонность к изоляции.</b> Вам так интересно в своей голове, что вы можете забыть о реальном мире.</li>
                </ul>
            `,
            stress: `
                <p>Вас выбивает из колеи:</p>
                <ul>
                    <li><b>Хаос и непредсказуемость.</b> Когда планы рушатся из-за чужой глупости.</li>
                    <li><b>Микроменеджмент.</b> Когда кто-то стоит над душой и говорит, как вам работать.</li>
                    <li><b>Шум и толпа.</b> Вам нужна тишина для концентрации.</li>
                    <li><b>Бессмысленные встречи.</b> Совещания, которые могли бы быть письмом — ваш личный ад.</li>
                </ul>
            `,
            relations: `
                <p>В общении вы избирательны. У вас мало друзей, но это люди, с которыми можно обсудить теорию струн или политику Древнего Рима в 3 часа ночи. Вы цените интеллектуальную честность.</p>
                <p>Светская болтовня о погоде вызывает у вас скуку. Вы часто кажетесь холодным или отстраненным, но на самом деле вы просто экономите энергию для важных разговоров. Если вы кого-то критикуете — это знак уважения; значит, вы верите, что человек может стать лучше.</p>
            `,
            love: `
                <p>К любви вы подходите как к проекту: ищете партнера, который будет соответствовать вашим высоким стандартам. Вам нужен не просто любовник, а интеллектуальный спарринг-партнер.</p>
                <p>Вы не склонны к бурным драмам и романтическим жестам с лепестками роз. Ваша любовь проявляется в делах: вы поможете партнеру решить сложную проблему или спланируете идеальное совместное будущее. Главная проблема — вы можете долго не замечать, что кому-то нравитесь, пока вам не скажут об этом прямо.</p>
            `
        },

        // --- ЗАГЛУШКИ ДЛЯ ОСТАЛЬНЫХ (ПОКА НЕ ЗАПОЛНИЛИ) ---
        "INTP": {
            name: "Ученый",
            desc: `
                <p>Вы — вечный исследователь вселенной. Ваша суперсила — превращать сложные теории в понятные системы. Вы живете в мире идей, гипотез и бесконечных вопросов «А что, если?». Вас не интересует, как принято делать; вас интересует, как это <i>работает на самом деле</i>.</p>
                <p>Вы часто кажетесь задумчивым и рассеянным профессором, который может забыть поесть, но решит уравнение, над которым бился весь отдел. Рутина, бюрократия и пустые светские беседы высасывают из вас жизнь.</p>
                <p>Вы цените истину выше комфорта. Если вы видите логическую ошибку, вы укажете на нее, даже если это расстроит собеседника. Не со зла, просто истина для вас — святое.</p>
            `,
            strengths: `
                <ul>
                    <li><b>Аналитический гений.</b> Вы замечаете паттерны и несостыковки, которые пропускают другие.</li>
                    <li><b>Оригинальность.</b> Ваш ум не зашорен стандартами. Вы находите решения, которые никому не приходили в голову.</li>
                    <li><b>Непредвзятость.</b> Вы принимаете решения на основе логики, а не эмоций или традиций.</li>
                    <li><b>Честность.</b> Вы не играете в социальные игры и говорите то, что думаете.</li>
                </ul>
            `,
            weaknesses: `
                <ul>
                    <li><b>Рассеянность.</b> Вы можете быть гением в физике, но забыть, где ключи от машины. Бытовые мелочи вас утомляют.</li>
                    <li><b>Склонность к изоляции.</b> Вам так хорошо наедине со своими мыслями, что вы забываете поддерживать отношения.</li>
                    <li><b>Перфекционизм.</b> Вы можете не заканчивать проекты, потому что «надо еще немного додумать».</li>
                    <li><b>Сложности с эмоциями.</b> Чужие (да и свои) бурные эмоции ставят вас в тупик. Вы пытаетесь их «решить» как задачу.</li>
                </ul>
            `,
            stress: `
                <p>Ваши главные враги:</p>
                <ul>
                    <li><b>Жесткие рамки.</b> Работа «от звонка до звонка» и строгий дресс-код убивают вашу креативность.</li>
                    <li><b>Эмоциональные конфликты.</b> Крики и драмы вызывают у вас желание спрятаться в бункер.</li>
                    <li><b>Глупость окружающих.</b> Необходимость объяснять очевидные вещи по 10 раз.</li>
                    <li><b>Рутина.</b> Заполнение бумажек и отчетов — ваш личный ад.</li>
                </ul>
            `,
            relations: `
                <p>Вы избирательны. Вам интересны люди, с которыми можно помолчать или обсудить квантовую физику. Вашим друзьям нравится ваша искренность и нестандартный юмор.</p>
                <p>В общении вы можете показаться отстраненным, но если кто-то затронет тему, которая вам интересна, вы превращаетесь в страстного оратора. Вы цените интеллект и способность мыслить широко.</p>
            `,
            love: `
                <p>В любви вы ищете прежде всего интеллектуальную совместимость. Вам нужен партнер, который поймет ваши идеи и не будет требовать постоянных эмоциональных излияний.</p>
                <p>Вы не мастер флирта и намеков. Если вы нравитесь кому-то, вам лучше сказать об этом прямо (и, возможно, предоставить доказательства). В отношениях вы преданны, честны и даете партнеру много свободы, ожидая того же взамен.</p>
            `
        },
        "ENTJ": { name: "Командир", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ENTP": { name: "Полемист", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "INFJ": { name: "Активист", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "INFP": { name: "Посредник", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ENFJ": { name: "Тренер", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ENFP": { name: "Борец", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ISTJ": { name: "Администратор", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ISFJ": { name: "Защитник", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ESTJ": { name: "Менеджер", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ESFJ": { name: "Консул", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ISTP": { name: "Виртуоз", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ISFP": { name: "Артист", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ESTP": { name: "Делец", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." },
        "ESFP": { name: "Развлекатель", desc: "Заглушка...", strengths: "...", weaknesses: "...", stress: "...", relations: "...", love: "..." }
    };
    // --- STATE ---
    let curLvl = 0;
    let curQ = 0;
    // MBTI
    let mbti = {E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0};
    // RIASEC
    let riasec = {R:0,I:0,A:0,S:0,E:0,C:0};
    // GPS DATA (Навыки и Фильтры)
    let userSkills = { math:5, art:5, stress:5, phys:5, lang:1, speak:5 }; 
    let userFilters = { blood:true, remoteOnly:false, manual:true, studyLong:true, schedule:false };

    // --- ЛОГИКА ---
    function nextScreen(id) {
        ['view-intro','view-level','view-quiz','view-result'].forEach(v => document.getElementById(v).classList.add('hidden'));
        document.getElementById('view-'+id).classList.remove('hidden');
        if(id === 'level') initLevel();
    }

    function initLevel() {
        const l = levels[curLvl];
        document.getElementById('lvl-num').innerText = `БЛОК ${curLvl+1} / 5`;
        document.getElementById('lvl-title').innerText = l.title;
        document.getElementById('lvl-desc').innerText = l.desc;
    }

    function startQuiz() {
        curQ = 0;
        nextScreen('quiz');
        renderQ();
    }

    function renderQ() {
        const q = levels[curLvl].qs[curQ];
        document.getElementById('q-counter').innerText = `ВОПРОС ${curQ+1} / ${levels[curLvl].qs.length}`;
        document.getElementById('q-text').innerText = q.text;
        
        // Progress
        document.getElementById('bar').style.width = ((curQ / levels[curLvl].qs.length) * 100) + "%";

        const btns = document.getElementById('type-btn');
        const slide = document.getElementById('type-slide');

        if(q.type === 'btn') {
            slide.classList.add('hidden');
            btns.classList.remove('hidden');
            btns.innerHTML = '';
            q.opts.forEach(o => {
                const b = document.createElement('button');
                b.className = 'btn';
                b.innerText = o.t;
                b.onclick = () => {
                    // MBTI
                    if(o.a) for(let k in o.a) mbti[k] += o.a[k];
                    // RIASEC
                    if(o.r) for(let k in o.r) riasec[k] += o.r[k];
                    // FILTERS (VETO)
                    if(o.filter) {
                        for(let k in o.filter) userFilters[k] = o.filter[k];
                    }
                    step();
                };
                btns.appendChild(b);
            });
        } else {
            btns.classList.add('hidden');
            slide.classList.remove('hidden');
            document.getElementById('slider').value = 5;
        }
    }

    function submitSlide() {
        const val = parseInt(document.getElementById('slider').value);
        const q = levels[curLvl].qs[curQ];
        const score = val - 5; 

        // 1. MBTI
        if(q.t_a) {
            if(score > 0) mbti[q.t_a] += score;
            else {
                const opp = {E:'I', I:'E', S:'N', N:'S', T:'F', F:'T', J:'P', P:'J'};
                mbti[opp[q.t_a]] += Math.abs(score);
            }
        }
        // 2. RIASEC
        if(q.t_r && val >= 5) riasec[q.t_r] += (val - 4);
        
        // 3. SKILLS (GPS)
        if(q.skill) {
            userSkills[q.skill] = val; // Записываем точное значение (0-10)
        }

        step();
    }

    function step() {
        curQ++;
        if(curQ < levels[curLvl].qs.length) renderQ();
        else {
            curLvl++;
            if(curLvl < levels.length) nextScreen('level');
            else finish();
        }
    }

    function finish() {
        nextScreen('result');
        
        // 1. Расчет MBTI (как было)
        let code = "";
        code += mbti.E >= mbti.I ? "E" : "I";
        code += mbti.S >= mbti.N ? "S" : "N";
        code += mbti.T >= mbti.F ? "T" : "F";
        code += mbti.J >= mbti.P ? "J" : "P";
        
        // Берем данные из базы (которую мы обновим ниже)
        const p = mbtiInfo[code]; 
        
        // Заполняем заголовок
        document.getElementById('res-code').innerText = code;
        document.getElementById('res-name').innerText = p.name; // Заменил n на name для читаемости

        // Заполняем НОВЫЕ поля (текст)
        document.getElementById('res-desc').innerHTML = p.desc;
        document.getElementById('res-strengths').innerHTML = p.strengths;
        document.getElementById('res-weaknesses').innerHTML = p.weaknesses;
        document.getElementById('res-stress').innerHTML = p.stress;
        document.getElementById('res-relations').innerHTML = p.relations;
        document.getElementById('res-love').innerHTML = p.love;

        // 2. График (оставляем тот же код отрисовки Chart...)
        const ctx = document.getElementById('radarChart').getContext('2d');
        // ... (код графика тот же, не меняй) ...
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['Реалист', 'Аналитик', 'Творец', 'Социал', 'Лидер', 'Системный'],
                datasets: [{
                    data: [riasec.R, riasec.I, riasec.A, riasec.S, riasec.E, riasec.C],
                    borderColor: '#1A1A1A', borderWidth: 2, backgroundColor: 'rgba(26,26,26,0.05)', 
                    pointBackgroundColor: '#FFF', pointBorderColor: '#1A1A1A'
                }]
            },
            options: {
                scales: {
                    r: {
                        suggestedMin: 0,
                        angleLines: {color: '#E5E5E5'}, grid: {color: '#E5E5E5'}, ticks: {display: false},
                        pointLabels: { font: { family: "'Inter', sans-serif", size: 11, weight: '700' }, color: '#1A1A1A' }
                    }
                },
                plugins: { legend: {display: false} },
                animation: { duration: 1500, easing: 'easeInOutQuart' }
            }
        });

        // 3. Подбор профессий и СОВЕТ
        let maxR = 1;
        for(let k in riasec) if(riasec[k] > maxR) maxR = riasec[k];

        jobs.forEach(j => {
            // (Тут твой код расчета с фильтрами и скиллами - оставь его!)
            // ... Вставь сюда ту логику расчета GPS из прошлого шага ...
            
            // ПОВТОРЮ РАСЧЕТ ДЛЯ ПРИМЕРА (чтобы ты не запутался):
            let dist = 0;
            ['R','I','A','S','E','C'].forEach(k => {
                let u = (riasec[k]/maxR)*100;
                dist += Math.abs(u - j.r[k]);
            });
            let baseScore = Math.max(0, 100 - (dist/5));

            if(j.req) {
                if(j.req.blood && !userFilters.blood) baseScore = 0;
                if(j.req.remote === false && userFilters.remoteOnly) baseScore = 0;
                if(j.req.manual && !userFilters.manual) baseScore = 0;
                if(j.req.study && !userFilters.studyLong) baseScore *= 0.5;
            }
            if(j.req && baseScore > 0) {
                if(j.req.math && userSkills.math < j.req.math) baseScore -= (j.req.math - userSkills.math) * 5;
                if(j.req.art && userSkills.art < j.req.art) baseScore -= (j.req.art - userSkills.art) * 5;
                if(j.req.stress && userSkills.stress < j.req.stress) baseScore -= (j.req.stress - userSkills.stress) * 3;
                if(j.req.phys && userSkills.phys < j.req.phys) baseScore -= (j.req.phys - userSkills.phys) * 5;
                if(j.req.lang && userSkills.lang < j.req.lang) baseScore -= 15;
                if(j.req.speak && userSkills.speak < j.req.speak) baseScore -= 10;
            }
            j.match = Math.round(Math.max(5, baseScore));
        });

        jobs.sort((a,b) => b.match - a.match);
        
        // ВЫВОД СПИСКА
        const list = document.getElementById('jobs-list');
        list.innerHTML = ""; // Очистка
        jobs.slice(0,5).forEach(j => {
            const row = document.createElement('div');
            row.className = 'job-row';
            row.innerHTML = `<span>${j.n}</span><span class="job-score">${j.match}%</span>`;
            list.appendChild(row);
        });

        // ВЫВОД СОВЕТА ДЛЯ ТОП-1
        const topJob = jobs[0];
        const adviceBox = document.getElementById('top-job-advice');
        // Если у профессии есть уникальный совет - берем его, иначе дефолтный
        const adviceText = topJob.advice 
            ? topJob.advice 
            : `Чтобы стартовать в профессии <b>${topJob.n}</b>, начните с изучения базовой теории и поиска стажировок. Эта сфера требует практики.`;
        
        adviceBox.innerHTML = `<div style="font-size:0.9em; text-transform:uppercase; color:#888; margin-bottom:10px;">Совет для старта:</div>${adviceText}`;
    }

    function toggle(el) {
        const item = el.parentElement;
        const icon = el.querySelector('.acc-icon');
        
        if(item.classList.contains('open')) {
            item.classList.remove('open');
            icon.innerText = '+';
        } else {
            item.classList.add('open');
            icon.innerText = '−';
        }
    }
</script>
</body>
</html>
